# DiaryQuest（ダイクエ）- 全体要件定義

## コンセプト
**「人生を冒険に、成長を経験値に」**

日記をRPG風のクエスト報告に見立て、日々の出来事を経験値に変換するアプリ。
音声入力とAI分析により、継続しやすく、成長を可視化する。

---

## 主要機能

### 1. 認証・オンボーディング
- **ログイン/サインアップ** (Firebase Auth)
- **ナビゲーター選択**
  - 5種類の相棒キャラクター（軍師、アニキ、精霊、騎士、猫妖精）
  - 各キャラクターは異なる性格でコメントを返す

### 2. ホーム画面 ✅ (実装済み)
- **プレイヤー情報**
  - レベル表示
  - XPバー（経験値進捗）
  - ゴールド（総経験値）
  - ジョブ名（職業）
- **統計情報**
  - 完了クエスト数
  - 連続日数（ストリーク）
  - フォーカスボーナス
- **スピリットバディ**
  - 相棒からのメッセージ
  - 吹き出し形式で表示
- **中央マイクボタン**
  - クエスト報告画面へ遷移

### 3. クエスト報告（日記入力）⭐ 核心機能
#### 3-1. 音声入力
- マイクボタンで録音開始/停止
- リアルタイム文字起こし（Speech-to-Text）
- 録音中はパルスアニメーション

#### 3-2. AI分析
- **サマリー生成**: 今日の出来事を要約
- **リフレーミング**: ポジティブな視点に変換
- **経験値計算**: 15項目のパラメータ別に経験値を付与
- **ナビゲーターコメント**: 選択した相棒の性格に応じたコメント

#### 3-3. 結果表示
- 獲得経験値の総計
- パラメータ別の内訳
- サマリーとリフレーミング内容
- 相棒のコメント

#### 3-4. 保存
- Firestoreにクエストエントリとして保存
- 日記履歴として蓄積

### 4. 成長パラメータシステム
#### 15項目のMECEパラメータ（5カテゴリ × 3項目）

**思考（Tactics）** - 青系
- 分析・構造化
- 企画・発想
- 専門知識

**実行（Execution）** - 緑系
- スピード
- 精度・品質
- 仕組み化

**対人（Social）** - ピンク系
- 交渉・調整
- 共感・サポート
- 言語化

**自制（Mastery）** - 紫系
- レジリエンス
- 規律・習慣
- メタ認知

**挑戦（Frontier）** - オレンジ系
- リスクテイク
- 学習棄却
- ビジョン設計

### 5. ジョブ（職業）システム
- **8種類のジョブ**
  - 戦略家、聖騎士、疾風の使い、革新者、賢者、外交官、設計士、不死鳥
- **解禁条件**: 特定パラメータが一定値に到達
- **表示**: プレイヤーヘッダーにジョブ名表示

### 6. スキルシステム
- **15種類のスキル**（各カテゴリ3つずつ）
- **解禁条件**: 総経験値が一定値に到達
- **段階的解禁**: 100 EXP → 200 EXP → 500 EXP

### 7. ステータス画面
- **パラメータ別の経験値グラフ**
- **カテゴリ別の成長状況**
- **解禁済みスキル一覧**
- **現在のジョブ**

### 8. 週次レポート
- **1週間の振り返り**
- **獲得経験値の推移**
- **成長したパラメータ**
- **ハイライト（印象的な出来事）**

### 9. 設定画面
- **ナビゲーター変更**
- **通知設定**
- **アカウント管理**
- **ログアウト**

---

## 技術スタック

### フロントエンド
- **Flutter** (Dart 3.10.7)
- **Riverpod** (状態管理)
- **Google Fonts** (Press Start 2P, VT323 - ピクセルアート風)

### バックエンド
- **Firebase Authentication** (認証)
- **Cloud Firestore** (データベース)

### AI/音声
- **Speech-to-Text** (音声認識)
- **AI API** (GPT等) - 分析・リフレーミング・経験値計算

### UI/UX
- **ピクセルアート風デザイン**
- **ライトテーマ** (白背景、明るい色)
- **レトロゲーム風のボーダーとシャドウ**

---

## データモデル

### UserModel
```dart
- id: String
- email: String
- displayName: String
- selectedNavigator: NavigatorType
- totalExp: int
- consecutiveDays: int
- baseLevel: int (削除予定)
- parameterExp: Map<GrowthParameter, int>
- unlockedSkills: List<String>
- unlockedJobs: List<String>
- currentJob: String?
- createdAt: DateTime
- lastActiveAt: DateTime
```

### QuestEntry
```dart
- id: String
- userId: String
- createdAt: DateTime
- rawTranscript: String (音声文字起こし)
- summary: String (要約)
- reframedContent: String (リフレーミング)
- earnedExp: Map<GrowthParameter, int>
- totalEarnedExp: int
- navigatorComment: String?
```

---

## 画面遷移

```
LoginScreen
  ↓
NavigatorSelectionScreen (初回のみ)
  ↓
HomeScreen (タブ: Home, Quest, Skill, Hero)
  ├─ Home: プレイヤー情報 + 統計 + 相棒メッセージ
  ├─ Quest: (準備中)
  ├─ Skill: JobSkillScreen
  └─ Hero: (準備中)
  
HomeScreen → [マイクボタン] → QuestReportScreen
  ├─ 音声入力
  ├─ AI分析
  └─ 結果表示 → HomeScreenに戻る
```

---

## 今後の実装予定

### 削除済み
- ❌ 拠点システム（BaseLevel, BaseBackground, BaseImageCard）

### 実装済み ✅
- ✅ ホーム画面のピクセルアート風UI
- ✅ プレイヤーヘッダー
- ✅ 統計情報カード
- ✅ スピリットバディメッセージ
- ✅ ライトテーマ

### 未実装・準備中
- ⏳ Quest画面（クエスト一覧）
- ⏳ Hero画面（プロフィール詳細）
- ⏳ 週次レポート画面
- ⏳ ステータス画面の詳細
- ⏳ ジョブ・スキル解禁アニメーション
- ⏳ ログインボーナス
- ⏳ 通知機能

---

## デザインガイドライン

### カラーパレット
- **背景**: `#F0F9FF` (ライトブルー)
- **カード**: `#FFFFFF` (白)
- **ボーダー**: `#2D3748` (ダークグレー)
- **プライマリ**: `#3182CE` (青)
- **セカンダリ**: `#D69E2E` (ゴールド)

### フォント
- **ピクセルフォント**: Press Start 2P (見出し、ラベル)
- **テキストフォント**: VT323 (本文)

### スタイル
- 角ばったボーダー（border-radius: 0）
- ピクセル風シャドウ（offset: 4px, blur: 0）
- 2-4pxの太いボーダー
- レトロゲーム風のアイコンとボタン

---

## ユーザー体験の流れ

1. **朝**: アプリを開く → 相棒が挨拶
2. **夜**: マイクボタンをタップ → 今日の出来事を話す
3. **分析**: AIが分析 → 経験値を獲得
4. **成長**: パラメータが上昇 → スキル・ジョブ解禁
5. **継続**: 連続日数が増える → ストリークボーナス
6. **振り返り**: 週次レポートで成長を実感

---

## 開発優先度

### P0 (最優先)
- ✅ ホーム画面UI
- 🔄 クエスト報告機能（音声入力 + AI分析）
- 🔄 経験値計算ロジック

### P1 (高優先)
- ジョブ・スキル解禁システム
- ステータス画面の詳細実装
- 週次レポート

### P2 (中優先)
- Quest画面（日記一覧）
- Hero画面（プロフィール）
- 通知機能

### P3 (低優先)
- ログインボーナス
- アニメーション強化
- ソーシャル機能（将来的に）
